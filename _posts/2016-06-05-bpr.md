---
layout: post
title: BPR介绍
description: 
modified: 2016-06-05
tags: 
---

# 介绍

本文讨论了个性化排序学习模型的一个通用方法。主要贡献有：

- 1.描述了通用的优化方法：BPR-OPT，它来自于对最优个性化排序的最大后验估计。我们展示了BPR-OPT在AUC上的分析。
- 2.对于最大化BPR-OPT，我们提出了通用学习算法LearnBPR，它基于SGD，在训练过程使用bootstrap sampling。我们展示了该算法会优于最优化BPR-OPT时的SGD。
- 3.我们展示了如何应用learnBPR到两个state-of-art推荐模型中
- 4.我们的实验经验上展示了个性化排序任务，使用BPR的模型效果要好于其它学习算法

# 2.相关工作

推荐系统中最流行的模型是kNN CF。传统上，kNN的相似矩阵通过heuristics进行计算（例如：Pearson相关度），但在最近的工作中，相似矩阵可以看成是模型参数，可以学到。最近，矩阵分解（MF）在推荐系统中非常流行，可以使用隐式和显式反馈。在最近工作中，SVD也被证明是可以学习特征矩阵。通过SVD学习得到的MF模型，被证明是很容易overfitting。因而提出了正则化学习方法。对于item的预测，Hu等人提出了一个带case weights的正则的最小二乘优化(WR-MF)。case weights可以被用于减小负样本的影响。Hofmann提出了一个概率隐语义模型来进行item推荐。Schmidt-Thieme将该问题转成一个multi-class问题，并使用一个二分类集合来求解它。即使在item预测上的上述所有工作。。。

本文中，我们主要关注模型参数的离线学习。将学习方法扩展到在线学习情况——例如：添加一个新用户，它的历史增加从0到1，2，... feedback事件——对于MF的排序预测已经被学到。相同的fold-in策略可以被用于BPR。

。。。

# 3.个性化排序（Personalized Ranking）

个性化排序的任务，会提供给一个用户一个items排序列表。这也被称为item推荐。一个示例是，在线电商希望推荐一个个性化的items排序列表，用户会从中购买。在本paper中，我们会调查这样的情况：ranking必须从用户的隐式行为进行infer（例如：过去的购买）。对隐式反馈系统感兴趣，只提供正向数据（正样本）。未观察到的user-item pairs（例如：一个用户不必购买一个item）会是一个真实负反馈（用户对购买该item不敢兴趣）以及缺失值（用户希望在未来购买该item）的混合。

## 3.1 公式化

<img src="">

图1: 

假设U是所有users的集合，I是所有items的集合。在我们的场景下，隐式反馈$$S \subseteq U \times I$$（见图1左侧）。这样的反馈示例为：电商中的购买行为，视频观看 或者 网页上的点击。推荐系统的任务是提供给用户一个个性化总排序：$$ >_u \subset I^2$$，其中$$>_u$$必须满足一个总顺序属性：

$$
\foreach i,j \in I: i \neq j \Rightarrow j >_u j \bigvee j >_u i		(totality) \\
\foreach i,j \in I: i >_u j \bigvee j >_u i \Rightarrow i = j 		(antisymmetry) \\
\foreach i,j \in I: i >_u j \bigvee j >_u k \Rightarrow i >_u k    (transitivity)
$$

出于便利，我们也定义了：

$$
I_u^+ := {i \in I: (u,i) \in S} \\
U_i^+ := {u \in U: (u,i) \in S}
$$

## 3.2 问题分析

前面提到，在隐式反馈系统中只有正例(positive classes)被观察到。剩余数据其实是实际负例(negative)与缺失值（missing value）的一个混合。对于拷贝缺失值问题，最常见的方法是，忽略所有。但接着典型的机器学习模型不能学习任何东西，因为他们两者间不能进行区分。

对于item推荐常用的方法是，对一个item预测一个个性化分$$\hat{x}_{ui}$$，它可以影响用户对该item的偏好。接着，该items会根据该分值进行排序。对于item推荐的机器学习方法，通常会从S中创建训练数据：给定pairs: $(u, i) \in S$$，一个正例label和所有在$$(U \times I) \ S$$中的其它组合，一个负例（见图1）。接着，模型会拟合该数据，这意味着模型的优化是为预测。

# 参考

[https://arxiv.org/pdf/1205.2618.pdf](https://arxiv.org/pdf/1205.2618.pdf)